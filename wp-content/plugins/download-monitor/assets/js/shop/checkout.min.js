jQuery(function(o){function s(d,r){var e=o("<div>").addClass("dlm-checkout-error");e.append(o("<img>").attr("src",dlm_strings.icon_error).attr("alt","Checkout error").addClass("dlm-checkout-error-icon")),e.append(o("<p>").html(r)),d.prepend(e)}function n(d){var r=o(".dlm-checkout-overlay:first"),e=o(".dlm-checkout-overlay-bg:first");r.fadeOut(300,function(){r.remove()}),e.fadeOut(300,function(){e.remove(),o(d).find("#dlm_checkout_submit").attr("disabled",!1)})}o("#dlm-form-checkout").submit(function(d){var r=o(this);o(r).find(".dlm-checkout-field-error").removeClass("dlm-checkout-field-error"),r.find(".dlm-checkout-error").remove(),function(d){o(d).find("#dlm_checkout_submit").attr("disabled",!0);var r=o("<div>").addClass("dlm-checkout-overlay-bg"),e=o("<div>").addClass("dlm-checkout-overlay");e.append(o("<h2>").html(dlm_strings.overlay_title)),e.append(o("<span>").html(dlm_strings.overlay_body)),e.append(o("<img>").attr("src",dlm_strings.overlay_img_src)),o("body").append(r),o("body").append(e),r.fadeIn(300,function(){e.css("display","block").css("top","47%"),e.animate({top:"+=3%"},300)})}(r);var e={first_name:r.find("#dlm_first_name").val(),last_name:r.find("#dlm_last_name").val(),company:r.find("#dlm_company").val(),email:r.find("#dlm_email").val(),address_1:r.find("#dlm_address_1").val(),postcode:r.find("#dlm_postcode").val(),city:r.find("#dlm_city").val(),country:r.find("#dlm_country").val()},a={payment_gateway:o("input[name=dlm_gateway]:checked",o(this)).val(),customer:e};void 0!==r.data("order_id")&&(a.order_id=r.data("order_id")),void 0!==r.data("order_hash")&&(a.order_hash=r.data("order_hash"));for(var t=[],i=!0,l=0;l<dlm_strings.required_fields.length;l++)""===e[dlm_strings.required_fields[l]]&&(i=!1,t.push(dlm_strings.required_fields[l]));return!1===i?(function(d,r){for(var e=0;e<r.length;e++)o(d).find("#dlm_"+r[e]).addClass("dlm-checkout-field-error")}(r,t),s(r,dlm_strings.error_message_required_fields),n(r)):o.post(dlm_strings.ajax_url_place_order,a,function(d){if(!0===d.success&&void 0!==d.redirect)return window.location.replace(d.redirect),!1;!1===d.success&&""!==d.error&&s(r,d.error),n(r)}),!1})});