var sowb=window.sowb||{};jQuery(function(o){sowb.setupAccordion=function(){o(".sow-accordion").each(function(n,a){var i=o(this).closest(".so-widget-sow-accordion");if(i.data("initialized"))return o(this);var e=i.data("useAnchorTags"),c=i.data("initialScrollPanel"),s=o(a).find("> .sow-accordion-panel");s.not(".sow-accordion-panel-open").find(".sow-accordion-panel-content").hide();var t=s.filter(".sow-accordion-panel-open").toArray(),r=function(){},d=function(n,a){var i=o(n);if(!i.is(".sow-accordion-panel-open")){i.find("> .sow-accordion-panel-content").slideDown(function(){o(this).trigger("show"),o(sowb).trigger("setup_widgets")}),i.addClass("sow-accordion-panel-open"),t.push(n);var e=o(n).parents(".sow-accordion-panel");e.length&&!e.hasClass("sow-accordion-panel-open")&&d(e.get(0),!0),a||r()}},w=function(n,a){var i=o(n);i.is(".sow-accordion-panel-open")&&(i.find("> .sow-accordion-panel-content").slideUp(function(){o(this).trigger("hide")}),i.removeClass("sow-accordion-panel-open"),t.splice(t.indexOf(n),1),a||r())};if(s.find("> .sow-accordion-panel-header").click(function(){var n=o(this),a=i.data("maxOpenPanels"),e=n.closest(".sow-accordion-panel");if(e.is(".sow-accordion-panel-open")?w(e.get(0)):d(e.get(0)),!isNaN(a)&&a>0&&t.length>a){var c=0;o.each(t.reverse(),function(o,n){c!==a?c++:w(t[o])})}}),e){r=function(){for(var n=[],a=o(".sow-accordion-panel-open").toArray(),i=0;i<a.length;i++){var e=o(a[i]).data("anchor");if(e){var c=o(a[i]).parents(".sow-accordion-panel");(!c.length||c.length&&c.hasClass("sow-accordion-panel-open"))&&(n[i]=e)}}n&&n.length?window.location.hash=n.join(","):window.history.pushState("",document.title,window.location.pathname+window.location.search)};var l=function(){for(var n=s.toArray(),a=0;a<n.length;a++){var i=n[a],e=o(i).data("anchor");e&&window.location.hash.indexOf(e)>-1?d(i,!0):w(i,!0)}};if(o(window).on("hashchange",l),window.location.hash?l():r(),c>0){var p=c>s.length?s.last():s.eq(c-1);window.scrollTo(0,p.offset().top-90)}}i.data("initialized",!0)})},sowb.setupAccordion(),o(sowb).on("setup_widgets",sowb.setupAccordion)}),window.sowb=sowb;