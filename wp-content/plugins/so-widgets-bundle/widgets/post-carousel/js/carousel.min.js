var sowb=window.sowb||{};jQuery(function(_){sowb.setupCarousel=function(){_(".sow-carousel-wrapper").each(function(){var t=_(this),e=t.closest(".sow-carousel-container"),a=t.closest(".sow-carousel-container").parent(),n=t.find(".sow-carousel-items"),s=t.find(".sow-carousel-item"),o=s.eq(0),u=0,i=1,r=!1,c=s.length,l=t.data("found-posts"),w=c===l,f=o.width()+parseInt(o.css("margin-right")),d=e.hasClass("js-rtl"),p=d?"margin-right":"margin-left",h=function(){u<0&&(u=0);var e=Math.ceil(t.outerWidth()/f);if(u+e>=t.find(".sow-carousel-item").length-1&&!r&&!w){r=!0,i++,n.append('<li class="sow-carousel-item sow-carousel-loading"></li>');var s=a.find('input[name="instance_hash"]').val();_.get(t.data("ajax-url"),{query:t.data("query"),action:"sow_carousel_load",paged:i,instance_hash:s},function(e,s){_(e.html).appendTo(n).hide().fadeIn(),t.find(".sow-carousel-loading").remove(),c=t.find(".sow-carousel-item").length,w=c===l,r=!1})}n.css("transition-duration","0.45s"),n.css(p,-f*u+"px")};if(a.on("click","a.sow-carousel-previous",function(e){e.preventDefault(),u-=d?-1:1,h()}),a.on("click","a.sow-carousel-next",function(e){e.preventDefault(),u+=d?-1:1,h()}),"function"==typeof t.swipe){var g,v=!1,m=0,b=0,D=0,I=0,T=d?"right":"left",x=function(e){return e<50&&-f*c<e&&(n.css("transition-duration","0s"),n.css(p,e+"px"),!0)},M=function(){var e=parseInt(n.css(p));u=Math.abs(Math.round(e/f)),h()};t.on("click",".sow-carousel-item a",function(e){v&&(e.preventDefault(),v=!1)}),t.swipe({excludedElements:"",triggerOnTouchEnd:!0,threshold:75,swipeStatus:function(e,s,a,n,t,o,i){if("up"===a||"down"===a)return!1;if("start"===s)b=-f*u,I=(new Date).getTime(),clearInterval(g);else if("move"===s){a===T&&(n*=-1),x(b+n);var r=(new Date).getTime();D=(n-m)/((r-I)/1e3),I=r,m=n}else if("end"===s)if(v=!0,a===T&&(n*=-1),400<Math.abs(D)){D*=.1;var c=(new Date).getTime(),l=0;g=setInterval(function(){var e=((new Date).getTime()-c)/1e3,s=b+n+(l+=D*e),t=Math.abs(D)-30<0;a===T?D+=30:D-=30,!t&&x(s)||(clearInterval(g),M())},20)}else M();else"cancel"===s&&h()}})}})},sowb.setupCarousel(),_(sowb).on("setup_widgets",sowb.setupCarousel)}),window.sowb=sowb;