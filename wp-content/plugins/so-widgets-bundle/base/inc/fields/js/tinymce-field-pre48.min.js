!function(v){var i=function(e){"undefined"!=typeof tinyMCEPreInit?(tinyMCEPreInit.mceInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.mceInit[void 0],tinyMCEPreInit.qtInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.qtInit[void 0],QTags.instances.hasOwnProperty("undefined")&&delete QTags.instances[void 0],v(e).find("> .siteorigin-widget-field-type-tinymce > .siteorigin-widget-tinymce-container").each(function(e,t){var i=v(t),a=i.find("textarea"),o=a.attr("id");if("undefined"!=typeof tinymce){if(-1<o.indexOf("__i__"))return;var n,r=i.data("mceSettings"),s=i.data("widgetIdBase"),c=a.attr("name").replace(/\[\d*\]/g,""),d=/[a-zA-Z0-9-]+(?:\[[a-zA-Z0-9]+\])?\[(.*)\]/.exec(c)[1],f=new RegExp("widget-"+s+"-?.*-"+d.replace(/\]\[/g,"-")+"[-d]*");for(var g in tinyMCEPreInit.mceInit)g.match(f)&&(r=v.extend({},tinyMCEPreInit.mceInit[g],r));var l=tinymce.get(o);null!==l&&("undefined"==typeof vc&&0===i.closest(".vc_active").length&&(n=l.getContent()),l.remove());if(r=v.extend({},r,{selector:"#"+o,setup:function(e){e.on("change",function(){tinymce.get(o).save(),a.trigger("change"),a.val(window.switchEditors.pre_wpautop(e.getContent()))}),e.on("init",function(){n&&e.setContent(n)})}}),tinyMCEPreInit.mceInit[o]=r,i.find("div#wp-"+o+"-wrap").hasClass("tmce-active"))if(v("#"+o).is(":visible"))tinymce.init(tinyMCEPreInit.mceInit[o]);else var m=setInterval(function(){v("#"+o).is(":visible")&&(tinymce.init(tinyMCEPreInit.mceInit[o]),clearInterval(m))},500)}var u=i.data("qtSettings");u=v.extend({},tinyMCEPreInit.qtInit["siteorigin-widget-input-tinymce-field"],u,{id:o}),tinyMCEPreInit.qtInit[o]=u,i.find(".quicktags-toolbar").remove(),quicktags(tinyMCEPreInit.qtInit[o]),v(this).on("click",function(e){var t=v(e.target);if(t.hasClass("wp-switch-editor")){var i=t.hasClass("switch-tmce")?"tmce":"html";if("tmce"==i){var n=tinymce.get(o);if(null!=n){var r=a.val();-1!=r.search("<")&&-1==r.search(">")&&(r=r.replace(/</g,""),a.val(r)),n.setContent(window.switchEditors.wpautop(r))}}v(this).find("+ .siteorigin-widget-tinymce-selected-editor").val(i)}})}),QTags._buttonsInit()):setTimeout(function(){i(e)},500)};v(document).on("sowsetupform",function(e){var t=v(e.target);t.is(".siteorigin-widget-field-repeater-item-form")?t.is(":visible")?i(t):t.on("slideToggleOpenComplete",function(){t.is(":visible")&&(i(t),t.off("slideToggleOpenComplete"))}):i(t)}),v(document).on("sortstop",function(e,t){t.item.is(".siteorigin-widget-field-repeater-item")?t.item.find("> .siteorigin-widget-field-repeater-item-form").each(function(){i(v(this))}):i(t.item.find(".siteorigin-widget-form"))})}(jQuery);