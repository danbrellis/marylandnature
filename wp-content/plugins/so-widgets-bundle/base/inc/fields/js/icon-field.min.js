!function(h){var u={};h(document).on("sowsetupformfield",".siteorigin-widget-field-type-icon",function(i){var e=h(this),g=e.find(".siteorigin-widget-icon-selector"),f=g.find(".siteorigin-widget-icon-icon"),v=e.find(".siteorigin-widget-icon-selector-current"),w=e.find(".so-icon-remove"),n=e.find(".siteorigin-widget-icon-search");if(!e.data("initialized")){v.click(function(){g.slideToggle(),n.val(""),y()}),w.click(function(i){i.preventDefault(),e.find(".siteorigin-widget-active").click()});var y=function(){var t=n.val().toLowerCase();""===t?g.find(".siteorigin-widget-icon-icons-icon").show():g.find(".siteorigin-widget-icon-icons-icon").each(function(){var i=h(this),e=i.attr("data-value");-1===(e=e.replace(/-/," ")).indexOf(t)?i.hide():i.show()})};n.keyup(y).change(y);var d=function(){var i=g.find("select.siteorigin-widget-icon-family").val(),e=g.find(".siteorigin-widget-icon-icons");if(void 0!==u[i]){e.empty();var t,n=u[i],s=n.icons;for(var o in n.hasOwnProperty("styles")&&n.styles&&(t=g.find(".siteorigin-widget-icon-family-styles").val()),0===h("#siteorigin-widget-font-"+i).length&&h("<link rel='stylesheet' type='text/css'>").attr("id","siteorigin-widget-font-"+i).attr("href",u[i].style_uri).appendTo("head"),s){var a=s[o],d=a.hasOwnProperty("unicode")?a.unicode:a;if(!a.hasOwnProperty("styles")||-1!==a.styles.indexOf(t)){var c="sow-icon-"+i+(t?" "+t:""),r=i+(t?"-"+t:"")+"-"+o,l=h('<div data-sow-icon="'+d+'"/>').attr("data-value",r).addClass(c).addClass("siteorigin-widget-icon-icons-icon").click(function(){var i=h(this);i.hasClass("siteorigin-widget-active")?(i.removeClass("siteorigin-widget-active"),f.val(""),v.find("span").hide(),w.hide()):(e.find(".siteorigin-widget-icon-icons-icon").removeClass("siteorigin-widget-active"),i.addClass("siteorigin-widget-active"),f.val(i.data("value")),v.find("span").show().attr("data-sow-icon",i.attr("data-sow-icon")).attr("class","").addClass(c),w.show()),f.trigger("change",{isRendering:!0}),g.slideUp()});e.append(l),f.val()===r&&(v.find("span").show().attr("data-sow-icon",l.attr("data-sow-icon")).attr("class","").addClass(c),l.addClass("siteorigin-widget-active"))}}e.prepend(e.find(".siteorigin-widget-active")),y()}},t=function(e){var t=g.find("select.siteorigin-widget-icon-family").val(),i=g.find("select.siteorigin-widget-icon-family option:selected").data("icons");if(null!==i&&(u[t]=i),void 0!==t&&""!==t)if(void 0===u[t]){var n=g.find(".siteorigin-widget-icon-icons");n.addClass("loading"),h.getJSON(soWidgets.ajaxurl,{action:"siteorigin_widgets_get_icons",family:g.find("select.siteorigin-widget-icon-family").val()},function(i){u[t]=i,function(i){var e=g.find("select.siteorigin-widget-icon-family"),t=e.val();if(void 0!==u[t]){var n=g.find(".siteorigin-widget-icon-family-styles");if(!i){n.off("change",d),n.remove();var s=u[t];if(s.hasOwnProperty("styles")&&s.styles){var o="";for(var a in s.styles)o+='<option value="'+a+'">'+s.styles[a]+"</option>";o&&(n=h('<select class="siteorigin-widget-icon-family-styles"></select>').append(o),e.after(n))}}n.on("change",d)}}(e),n.removeClass("loading"),d()})}else d()};t(!0),g.find("select.siteorigin-widget-icon-family").change(function(){g.find(".siteorigin-widget-icon-icons").empty(),t()}),f.change(function(i,e){e&&e.isRendering||d()}),e.data("initialized",!0)}})}(jQuery);